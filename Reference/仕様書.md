# ゲーム仕様書：SOMEBODY SUMMON ME! (2026 GGJ Edition)

## 1. プロジェクト概要

* **タイトル:** SOMEBODY SUMMON ME!
* **ジャンル:** 感染型NPC大乱闘アクション
* **コンセプト:** 敵（警察官）をパーティーに「勧誘（感染）」して味方を増やし、盤面を緑（MASK）で埋め尽くす。
* **プレイヤーの役割:** 指揮官兼ヒーラー。直接的な殺傷よりも、戦線の維持と蘇生を主導する。

## 2. コア・メカニクス

### A. 感染・転生システム (Infection & Respawn)

* **挙動:** 敵（Team: BadGuys）のHPが0になった際、オブジェクトを破棄せず、その座標に味方NPC（Team: Green / ミニMASK）を即座に生成する。
* **目的:** 勝利＝敵の全滅ではなく、敵の総数を味方の総数へ変換すること。

### B. 不死・気絶システム (Dizzy State)

* **挙動:** 味方NPC（Team: Green）は、HPが0になっても破壊（Destroy）されない。
* **状態:** `IsDizzy` フラグを真とし、専用のダウン演出（頭上に星が回る等）へ移行。Colliderを無効化し、敵のターゲットから除外される。
* **仕様:** この状態は後述の「グローバル・アンコール」によってのみ解除される。

### C. グローバル・アンコール (Global Revival Skill)

* **発動条件:** プレイヤーによる能動的スキル発動。
* **効果:** シーン上の全 `IsDizzy` 状態の味方NPCを検索し、HP全快で復活させる。復活したNPCはプレイヤーの周囲（または現在地）で `FollowPlayer` ステートへ移行する。
* **制約:** クールダウン（CD）60秒。

### D. 集団合体システム (The Merge 10)

* **条件:** 「ミニMASK」がプレイヤーの周囲に10体以上存在する場合。
* **挙動:** 10体を統合し、1体の強化ユニット「帽子付きMASK」を生成する。
* **目的:** ユニットの密度を上げ、処理負荷を軽減しつつ、軍団の質的向上を図る。

## 3. 既存クラスへの拡張指針（AIへの実装ガイド）

エージェントAIは、以下の既存クラスを解析し、仕様に沿ってリファクタリングせよ。

### ① StatusManager.cs

* `Team` 列挙型（Green, BadGuys）の導入。
* `IsDizzy` フラグの追加。
* `OnDeath` イベントの書き換え：
* BadGuysの場合 → ミニMASKプレハブのインスタンス化。
* Greenの場合 → `IsDizzy` 移行、死亡処理のバイパス。



### ② EnemyAI.cs

* **新規ステートの追加:** `Wander`（徘徊）, `FollowPlayer`（追従）, `Dizzy`（気絶）。
* **ターゲット選別ロジックの修正:** `IsDizzy` 状態の個体をターゲットから除外。BadGuysはPlayerを優先ターゲットとする。

### ③ DamageSource.cs

* チーム属性に基づいたダメージフィルター（Friendly Fireの防止）の確認。

## 4. 評価軸（上手さの定義）

* **上手いプレイ:** 蘇生スキル（60s CD）に頼らず、感染と合体のサイクルを回して軍勢を維持し続ける。
* **リカバリー:** 全滅の危機に陥っても、60秒間逃げ切り、一斉蘇生で戦線を立て直す。

---